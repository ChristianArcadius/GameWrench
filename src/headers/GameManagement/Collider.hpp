#pragma once

#include "SpriteCollection.hpp"

namespace gw {

class Collider
{
friend class Game;

public:

///////////////////////////////////////////////////////////////////////////////////////////////////
// Constructors 
///////////////////////////////////////////////////////////////////////////////////////////////////

    Collider(std::function<void(Sprite& sprite, Sprite& collidedWith, Vector2f collision)>
        handleCollision);

	virtual ~Collider() = default;

///////////////////////////////////////////////////////////////////////////////////////////////////
// Mutators 
///////////////////////////////////////////////////////////////////////////////////////////////////

    Collider& applyCollision(Sprite& sprite);
    Collider& applyCollision(SpriteCollection& sprite);
    Collider& canCollideWith(Sprite& sprite);
    Collider& canCollideWith(SpriteCollection& sprite);

private:

///////////////////////////////////////////////////////////////////////////////////////////////////
// Private Methods 
///////////////////////////////////////////////////////////////////////////////////////////////////

    // Check for and resolve collisions using checkCollision and handleCollision
    void resolveCollisions();

    // Method of collision detection used by this Collider
    virtual gw::Vector2f checkCollision(gw::Sprite& sprite1, gw::Sprite& sprite2) = 0;

///////////////////////////////////////////////////////////////////////////////////////////////////
// Private Members 
///////////////////////////////////////////////////////////////////////////////////////////////////

    SpriteCollection sprites;       // Sprites to check for collision
    SpriteCollection collidables;   // Sprites to check if sprites are colliding with

	// What to do when two objects collide
    std::function<void(Sprite& sprite, Sprite& collidedWith, Vector2f collision)> handleCollision;
};

} // namespace gw